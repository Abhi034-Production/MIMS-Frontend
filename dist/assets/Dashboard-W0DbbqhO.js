import{r as l,A as $,a as f,j as e,L as O,S as q,b as I,M as B,c as U,d as _,e as b,f as z,g as F}from"./index-Ct45hBRj.js";import{E as Q}from"./jspdf.es.min-DNBeW_5t.js";import{f as v,p as G}from"./parseISO-DE7PhNio.js";const V=()=>{const[o,w]=l.useState({totalRevenue:0,monthlyRevenue:0,totalOrders:0,totalCustomers:0,totalProducts:"10+"}),[y,j]=l.useState([]),[i,N]=l.useState(5e4),[H,k]=l.useState([]),[d,S]=l.useState([]),{user:c}=l.useContext($),[r,M]=l.useState(null),R=()=>{const t=new Q;t.text("Low Stock Inventory Report",14,15),autoTable(t,{startY:25,head:[["Product Name","Quantity","Price"]],body:d.map(a=>[a.name,a.quantity,`â‚¹${a.price}`])}),t.save("low_stock_inventory.pdf")};return l.useEffect(()=>{!c||!c.email||fetch(`https://mims-backend-x0i3.onrender.com/business-profile/${c.email}`).then(t=>t.json()).then(t=>{t.status==="success"&&M(t.profile)}).catch(()=>{})},[c]),l.useEffect(()=>{!r||!r.businessEmail||(f.get(`https://mims-backend-x0i3.onrender.com/bills?businessEmail=${encodeURIComponent(r.businessEmail)}`).then(t=>{const a=t.data,P=v(new Date,"yyyy-MM"),x=a.filter(n=>{const s=G(n.billDate);return v(s,"yyyy-MM")===P}),T=a.reduce((n,s)=>n+s.total,0),g=x.reduce((n,s)=>n+s.total,0),E=new Set(x.map(n=>n.customer?.email)).size,D=x.length,L=Math.ceil(g/5e4)*5e4||5e4;N(L),w({totalRevenue:T,monthlyRevenue:g,totalOrders:D,totalCustomers:E,totalProducts:"10+"});const m={};x.forEach(n=>{n.order.forEach(s=>{const h=s.product?.name||s.productName,p=s.quantity;h&&(m[h]?m[h]+=p:m[h]=p)})});const C=Object.entries(m).map(([n,s])=>({name:n,sold:s})).sort((n,s)=>s.sold-n.sold).slice(0,5);j(C);const A=Array.from({length:Math.floor(g/5e4)},(n,s)=>`â‚¹${(s+1)*5e4} Achieved`);k(A)}).catch(t=>console.error("Error fetching data:",t)),f.get(`https://mims-backend-x0i3.onrender.com/products?email=${encodeURIComponent(r.businessEmail)}`).then(t=>{const a=t.data.filter(u=>u.quantity!==void 0&&u.quantity<5);S(a)}).catch(t=>console.error("Error fetching products:",t)))},[r]),e.jsxs(O,{children:[e.jsx(q,{title:"Dashboard | easyinventory",description:"Monitor revenue, track orders, view top-selling products, and manage inventory from the easyinventory Admin Dashboard.",keywords:" dashboard, inventory analytics, sales tracking, easyinventory",url:"https://easyinventory.online/admin-dashboard"}),e.jsx("div",{className:"text-sm dark:text-white text-gray-600 mb-4",children:e.jsxs("nav",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-500 dark:text-white",children:e.jsx(I,{to:"/home",children:e.jsx(B,{fontSize:20})})}),e.jsx("span",{className:"text-gray-400 dark:text-white",children:"/"}),e.jsx("span",{className:"font-semibold dark:text-white text-gray-800",children:"Dashboard"})]})}),e.jsxs("div",{className:"p-4 md:p-8 bg-gray-50 dark:text-white dark:bg-gray-900 min-h-screen transition-colors",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8 dark:bg-gray-900",children:[{icon:e.jsx("p",{className:"text-4xl text-green-800",children:"â‚¹"}),title:"Total Revenue",value:`â‚¹${o.totalRevenue.toLocaleString()}`},{icon:e.jsx("p",{className:"text-4xl text-green-800",children:"â‚¹"}),title:"Monthly Revenue",value:`â‚¹${o.monthlyRevenue.toLocaleString()}`},{icon:e.jsx(U,{className:"text-4xl text-orange-500"}),title:"Total Orders (This Month)",value:o.totalOrders},{icon:e.jsx(_,{className:"text-4xl text-purple-600"}),title:"Total Customers (This Month)",value:o.totalCustomers},{icon:e.jsx(b,{className:"text-4xl text-red-600"}),title:"Total Products",value:o.totalProducts}].map((t,a)=>e.jsxs("div",{className:"flex items-center gap-4 p-5 bg-white dark:bg-gray-800 rounded-2xl shadow hover:shadow-lg transition duration-300",children:[t.icon,e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 dark:text-white",children:t.title}),e.jsx("p",{className:"text-xl font-bold text-gray-800 dark:text-white",children:t.value})]})]},a))}),e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-2xl shadow transition-all duration-300 mb-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[e.jsx(z,{className:"text-3xl text-indigo-600"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"ðŸŽ¯ Monthly Sales Target Progress"})]}),e.jsx("div",{className:"relative w-full h-6 bg-gradient-to-r from-gray-200 to-gray-300 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"absolute top-0 left-0 h-full bg-gradient-to-r from-indigo-500 via-blue-500 to-sky-500 rounded-full shadow-md transition-all duration-700 ease-in-out",style:{width:`${Math.min(o.monthlyRevenue/i*100,100)}%`}})}),e.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row items-center justify-between text-sm gap-2",children:[e.jsxs("p",{className:"text-gray-700 font-semibold dark:text-white",children:[e.jsxs("span",{className:"text-base font-bold text-indigo-600 dark:text-indigo-300",children:["â‚¹",o.monthlyRevenue.toLocaleString()]})," ","of â‚¹",i.toLocaleString()]}),e.jsx("div",{className:"text-yellow-700 font-semibold text-left text-sm dark:text-yellow-300",children:`â­ ${Math.floor(o.monthlyRevenue/5e4)} Stars`}),o.monthlyRevenue>=i?e.jsx("span",{className:"inline-block px-4 py-1 text-xs font-bold bg-green-100 dark:bg-green-700 text-green-700 dark:text-white rounded-full shadow-sm",children:"âœ… Goal Achieved!"}):e.jsxs("span",{className:"inline-block px-4 py-1 text-xs font-medium bg-yellow-100 dark:bg-yellow-700 text-yellow-700 dark:text-white rounded-full shadow-sm",children:[Math.floor(o.monthlyRevenue/i*100),"% Achieved"]})]})]}),e.jsxs("div",{className:" dark:bg-gray-800 p-6 bg-white rounded-2xl shadow hover:shadow-lg transition duration-300",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx(F,{className:"text-2xl text-yellow-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-700 dark:text-white",children:"Top 5 Selling Products (This Month)"})]}),y.length>0?e.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:y.map((t,a)=>e.jsxs("li",{className:"flex justify-between py-3 text-gray-700 dark:text-white",children:[e.jsx("span",{className:"font-medium dark:text-white",children:t.name}),e.jsxs("span",{className:"font-bold text-blue-600 dark:text-blue-300",children:[t.sold," sold"]})]},a))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-300",children:"No sales data available for this month."})]}),e.jsxs("div",{className:"p-6 bg-white dark:bg-gray-800 rounded-2xl shadow hover:shadow-lg transition duration-300 mt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"text-2xl text-red-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-700 dark:text-white",children:"Low Stock Inventory (Less than 5)"})]}),d.length>0&&e.jsx("button",{onClick:R,className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-md text-sm",children:"ðŸ“„ Download PDF"})]}),d.length>0?e.jsx("ul",{className:"divide-y divide-gray-200",children:d.map((t,a)=>e.jsxs("li",{className:"flex justify-between py-3 text-gray-700 dark:text-white",children:[e.jsx("span",{children:t.name}),e.jsxs("span",{className:"text-sm",children:["Qty: ",t.quantity," | â‚¹",t.price]})]},a))}):e.jsx("p",{className:"text-sm text-gray-500 dark:text-white",children:"All inventory is sufficiently stocked."})]})]})]})};export{V as default};
